<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dianda.shserc.mapper.ResourceMapper">
    <select id="selectResources" resultType="com.dianda.shserc.entity.Resource">
        select r.id,
        r.title,
        r.description,
        r.state_id,
        r.stage_id,
        r.grade_id,
        r.domain_id,
        r.subject_id,
        r.school_type_id,
        r.import_source_id,
        r.deformity_id,
        r.author,
        r.author_address,
        r.author_email,
        r.author_phone,
        r.description,
        r.title,
        r.is_link,
        r.file_size,
        r.keywords,
        r.view_count,
        r.download_count,
        r.favorite_count
        r.comment_count,
        r.star_count,

        from resource r
        <where>
            ${ew.sqlSegment}
        </where>
    </select>

    <insert id="addViewCount" parameterType="com.dianda.shserc.entity.ResourceOperation">
		 insert into res_view (resource_id, user_id, add_date) values(#{resourceId} ,#{userId},#{addTime})
	</insert>

    <insert id="addDownloadCount" parameterType="com.dianda.shserc.entity.ResourceOperation">
		 insert into res_download (resource_id, user_id, add_date) values(#{resourceId} ,#{userId},#{addTime})
	</insert>

    <insert id="addFavoriteCount" parameterType="com.dianda.shserc.entity.ResourceOperation">
		 insert into res_favorite (resource_id, user_id, add_date) values(#{resourceId} ,#{userId},#{addTime})
	</insert>

    <insert id="addStarCount" parameterType="com.dianda.shserc.entity.ResourceOperation">
         insert into res_star (resource_id,user_id, score, add_date) values(#{resourceId},#{userId},#{operIntResult},#{addTime})
    </insert>

</mapper>